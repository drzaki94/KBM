<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KBM TOOLKIT - Home</title>
    
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#0f766e">
    <link rel="apple-touch-icon" href="icon-512.png">

    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        /* Smooth fade for install button */
        #installBtn { transition: all 0.3s ease; }
    </style>
</head>
<body class="bg-slate-100 min-h-screen py-10 px-4 flex items-center justify-center">

    <div class="max-w-md w-full bg-white shadow-xl rounded-xl overflow-hidden border border-slate-200">
        
        <div class="bg-teal-700 text-white p-8 text-center relative">
            <h1 class="text-3xl font-extrabold uppercase tracking-wide">KBM TOOLKIT</h1>
            <p class="text-teal-100 text-sm mt-2">Klinik Berhenti Merokok & Education Toolkit</p>
        </div>

        <div id="installContainer" class="hidden px-6 pt-4">
            <button id="installBtn" class="w-full bg-teal-600 text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:bg-teal-700 flex items-center justify-center gap-2">
                <span>üì≤</span> Install App
            </button>
        </div>

        <div class="p-6 space-y-4">
            <a href="first_tca.html" class="block group">
                <div class="flex items-center p-4 bg-white border-2 border-slate-100 rounded-xl hover:border-emerald-500 hover:bg-emerald-50 transition-all shadow-sm">
                    <div class="bg-emerald-100 text-emerald-700 p-3 rounded-lg mr-4 group-hover:bg-emerald-600 group-hover:text-white transition-colors">
                        <span class="text-2xl">üìù</span>
                    </div>
                    <div>
                        <h2 class="font-bold text-gray-800 text-lg">NEW TCA CLERKING</h2>
                        <p class="text-xs text-gray-500">Initial follow-up assessment & progress</p>
                    </div>
                </div>
            </a>

            <a href="clerking.html" class="block group">
                <div class="flex items-center p-4 bg-white border-2 border-slate-100 rounded-xl hover:border-teal-500 hover:bg-teal-50 transition-all shadow-sm">
                    <div class="bg-teal-100 text-teal-700 p-3 rounded-lg mr-4 group-hover:bg-teal-600 group-hover:text-white transition-colors">
                        <span class="text-2xl">üìã</span>
                    </div>
                    <div>
                        <h2 class="font-bold text-gray-800 text-lg">Clerking Sheet</h2>
                        <p class="text-xs text-gray-500">Patient assessment, Fagerstrom, & Plan</p>
                    </div>
                </div>
            </a>

            <a href="education.html" class="block group">
                <div class="flex items-center p-4 bg-white border-2 border-slate-100 rounded-xl hover:border-blue-500 hover:bg-blue-50 transition-all shadow-sm">
                    <div class="bg-blue-100 text-blue-700 p-3 rounded-lg mr-4 group-hover:bg-blue-600 group-hover:text-white transition-colors">
                        <span class="text-2xl">üìö</span>
                    </div>
                    <div>
                        <h2 class="font-bold text-gray-800 text-lg">Education</h2>
                        <p class="text-xs text-gray-500">Counselling tools, 5A's, 5R's & Timeline</p>
                    </div>
                </div>
            </a>

            <a href="medication.html" class="block group">
                <div class="flex items-center p-4 bg-white border-2 border-slate-100 rounded-xl hover:border-indigo-500 hover:bg-indigo-50 transition-all shadow-sm">
                    <div class="bg-indigo-100 text-indigo-700 p-3 rounded-lg mr-4 group-hover:bg-indigo-600 group-hover:text-white transition-colors">
                        <span class="text-2xl">üíä</span>
                    </div>
                    <div>
                        <h2 class="font-bold text-gray-800 text-lg">Medication</h2>
                        <p class="text-xs text-gray-500">Pharmacotherapy guide & dosing</p>
                    </div>
                </div>
            </a>

            <!-- Added QR Code Link -->
            <a href="https://drive.google.com/file/d/1i3o7ZSwhkJlT0x5vTNGYkwbAMlahF-cH/view?usp=sharing" target="_blank" rel="noopener noreferrer" class="block group">
                <div class="flex items-center p-4 bg-white border-2 border-slate-100 rounded-xl hover:border-violet-500 hover:bg-violet-50 transition-all shadow-sm">
                    <div class="bg-violet-100 text-violet-700 p-3 rounded-lg mr-4 group-hover:bg-violet-600 group-hover:text-white transition-colors">
                        <span class="text-2xl">üì±</span>
                    </div>
                    <div>
                        <h2 class="font-bold text-gray-800 text-lg">QR Code ILI HRG TB</h2>
                        <p class="text-xs text-gray-500">Resource access QR Code</p>
                    </div>
                </div>
            </a>

            <!-- Added Spreadsheet Link -->
            <a href="https://docs.google.com/spreadsheets/d/1M3u6Zn5GDuWK11zHrd_q3hfdSJQfg7u6bYA-mp0nw4Q/edit?usp=drive_link" target="_blank" rel="noopener noreferrer" class="block group">
                <div class="flex items-center p-4 bg-white border-2 border-slate-100 rounded-xl hover:border-amber-500 hover:bg-amber-50 transition-all shadow-sm">
                    <div class="bg-amber-100 text-amber-700 p-3 rounded-lg mr-4 group-hover:bg-amber-600 group-hover:text-white transition-colors">
                        <span class="text-2xl">üìà</span>
                    </div>
                    <div>
                        <h2 class="font-bold text-gray-800 text-lg">Retem KBM 2026</h2>
                        <p class="text-xs text-gray-500">Statistics & Spreadsheet tracking</p>
                    </div>
                </div>
            </a>
        </div>

        <div class="bg-slate-50 border-t border-gray-200 p-4 text-xs text-gray-500 leading-snug">
            <div class="grid gap-2">
                <div>
                    <p class="font-bold text-gray-700 uppercase mb-1">¬© 2025 Dr. Muhammad Zaki Abdul Razak</p>
                    <p>Protected by <strong>Malaysia Copyright Act 1987</strong>.</p>
                </div>
                <div>
                    <p class="font-bold text-gray-700 uppercase mb-1">Disclaimer</p>
                    <p><strong>For educational & documentation use only.</strong> Not medical advice. Clinicians must independently verify plans against current CPGs. The developer assumes no liability for clinical outcomes. Use at your own risk.</p>
                </div>
            </div>
        </div>

        <div class="bg-gray-100 p-4 text-center text-xs text-gray-400 border-t border-gray-200 font-mono">
            KBM TOOLKIT v2.3 (PWA)
        </div>
    </div>

    <script>
        // 1. Register Service Worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then(reg => console.log('SW Registered!', reg))
                    .catch(err => console.log('SW Failed', err));
            });
        }

        // 2. Handle Install Prompt
        let deferredPrompt;
        const installContainer = document.getElementById('installContainer');
        const installBtn = document.getElementById('installBtn');

        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            installContainer.classList.remove('hidden');
        });

        installBtn.addEventListener('click', (e) => {
            installContainer.classList.add('hidden');
            deferredPrompt.prompt();
            deferredPrompt.userChoice.then((choiceResult) => {
                if (choiceResult.outcome === 'accepted') {
                    console.log('User accepted the install prompt');
                } else {
                    console.log('User dismissed the install prompt');
                }
                deferredPrompt = null;
            });
        });
    </script>
</body>
</html>